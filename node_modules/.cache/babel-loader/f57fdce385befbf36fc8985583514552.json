{"remainingRequest":"D:\\vue-project\\xdclass_front\\node_modules\\_thread-loader@2.1.3@thread-loader\\dist\\cjs.js!D:\\vue-project\\xdclass_front\\node_modules\\_babel-loader@8.2.2@babel-loader\\lib\\index.js??ref--16-2!D:\\vue-project\\xdclass_front\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js??ref--0-0!D:\\vue-project\\xdclass_front\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js??vue-loader-options!D:\\vue-project\\xdclass_front\\node_modules\\_cube-ui@1.12.44@cube-ui\\src\\components\\upload\\upload.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue-project\\xdclass_front\\node_modules\\_cube-ui@1.12.44@cube-ui\\src\\components\\upload\\upload.vue","mtime":499162500000},{"path":"D:\\vue-project\\xdclass_front\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-project\\xdclass_front\\node_modules\\_thread-loader@2.1.3@thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-project\\xdclass_front\\node_modules\\_babel-loader@8.2.2@babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\vue-project\\xdclass_front\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-project\\xdclass_front\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNwbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmRhdGUubm93LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZGF0ZS50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IFVwbG9hZEJ0biBmcm9tICcuL2J0bi52dWUnOwppbXBvcnQgVXBsb2FkRmlsZSBmcm9tICcuL2ZpbGUudnVlJzsKaW1wb3J0IGFqYXhVcGxvYWQgZnJvbSAnLi9hamF4JzsKaW1wb3J0IGJ0bk1peGluIGZyb20gJy4vYnRuLW1peGluJzsKaW1wb3J0IHsgcHJvY2Vzc0ZpbGVzLCBuZXdGaWxlLCBVUkwsIFNUQVRVU19SRUFEWSwgU1RBVFVTX1VQTE9BRElORywgU1RBVFVTX0VSUk9SLCBTVEFUVVNfU1VDQ0VTUyB9IGZyb20gJy4vdXRpbCc7CnZhciBDT01QT05FTlRfTkFNRSA9ICdjdWJlLXVwbG9hZCc7CnZhciBFVkVOVF9JTlBVVCA9ICdpbnB1dCc7CnZhciBFVkVOVF9BRERFRCA9ICdmaWxlcy1hZGRlZCc7CnZhciBFVkVOVF9TVUJNSVRURUQgPSAnZmlsZS1zdWJtaXR0ZWQnOwp2YXIgRVZFTlRfUkVNT1ZFRCA9ICdmaWxlLXJlbW92ZWQnOwp2YXIgRVZFTlRfU1VDQ0VTUyA9ICdmaWxlLXN1Y2Nlc3MnOwp2YXIgRVZFTlRfRVJST1IgPSAnZmlsZS1lcnJvcic7CnZhciBFVkVOVF9DTElDSyA9ICdmaWxlLWNsaWNrJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6IENPTVBPTkVOVF9OQU1FLAogIG1peGluczogW2J0bk1peGluXSwKICBwcm9wczogewogICAgdmFsdWU6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgICJkZWZhdWx0IjogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CiAgICB9LAogICAgYWN0aW9uOiB7CiAgICAgIHR5cGU6IFtTdHJpbmcsIE9iamVjdF0sCiAgICAgICJkZWZhdWx0IjogJycKICAgIH0sCiAgICBtYXg6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICAiZGVmYXVsdCI6IDEwCiAgICB9LAogICAgYXV0bzogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICAiZGVmYXVsdCI6IHRydWUKICAgIH0sCiAgICBzaW11bHRhbmVvdXNVcGxvYWRzOiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgImRlZmF1bHQiOiAxCiAgICB9LAogICAgcHJvY2Vzc0ZpbGU6IHsKICAgICAgdHlwZTogRnVuY3Rpb24sCiAgICAgICJkZWZhdWx0IjogZnVuY3Rpb24gX2RlZmF1bHQoZmlsZSwgY2IpIHsKICAgICAgICBjYihmaWxlKTsKICAgICAgfQogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZpbGVzOiB0aGlzLnZhbHVlLAogICAgICBwYXVzZWQ6ICF0aGlzLmF1dG8KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgYWN0aW9uT3B0aW9uczogZnVuY3Rpb24gYWN0aW9uT3B0aW9ucygpIHsKICAgICAgdmFyIGFjdGlvbiA9IHRoaXMuYWN0aW9uOwoKICAgICAgaWYgKHR5cGVvZiBhY3Rpb24gPT09ICdzdHJpbmcnKSB7CiAgICAgICAgcmV0dXJuIGFjdGlvbiA/IHsKICAgICAgICAgIHRhcmdldDogYWN0aW9uCiAgICAgICAgfSA6IG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGFjdGlvbjsKICAgICAgfQogICAgfSwKICAgIGlzU2hvd0J0bjogZnVuY3Rpb24gaXNTaG93QnRuKCkgewogICAgICByZXR1cm4gdGhpcy5maWxlcy5sZW5ndGggPCB0aGlzLm1heDsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICB2YWx1ZTogZnVuY3Rpb24gdmFsdWUobmV3VmFsKSB7CiAgICAgIHRoaXMuZmlsZXMgPSBuZXdWYWw7CiAgICB9LAogICAgZmlsZXM6IGZ1bmN0aW9uIGZpbGVzKG5ld0ZpbGVzKSB7CiAgICAgIHRoaXMuJGVtaXQoRVZFTlRfSU5QVVQsIG5ld0ZpbGVzKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGFkZEZpbGVzOiBmdW5jdGlvbiBhZGRGaWxlcyhmaWxlcykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdGhpcy4kZW1pdChFVkVOVF9BRERFRCwgZmlsZXMpOwogICAgICB2YXIgZmlsZXNMZW4gPSB0aGlzLmZpbGVzLmxlbmd0aDsKICAgICAgdmFyIG5ld0ZpbGVzID0gW107CiAgICAgIHZhciBtYXhMZW4gPSB0aGlzLm1heCAtIGZpbGVzTGVuOwogICAgICB2YXIgaSA9IDA7CiAgICAgIHZhciBmaWxlID0gZmlsZXNbaV07CgogICAgICB3aGlsZSAobmV3RmlsZXMubGVuZ3RoIDwgbWF4TGVuICYmIGZpbGUpIHsKICAgICAgICBpZiAoIWZpbGUuaWdub3JlKSB7CiAgICAgICAgICBuZXdGaWxlcy5wdXNoKGZpbGUpOwogICAgICAgICAgdGhpcy5maWxlcy5wdXNoKG5ld0ZpbGUoKSk7CiAgICAgICAgfQoKICAgICAgICBmaWxlID0gZmlsZXNbKytpXTsKICAgICAgfQoKICAgICAgcHJvY2Vzc0ZpbGVzKG5ld0ZpbGVzLCB0aGlzLnByb2Nlc3NGaWxlLCBmdW5jdGlvbiAoZmlsZSwgaW5kZXgpIHsKICAgICAgICBfdGhpcy4kc2V0KF90aGlzLmZpbGVzLCBmaWxlc0xlbiArIGluZGV4LCBmaWxlKTsKCiAgICAgICAgX3RoaXMuJGVtaXQoRVZFTlRfU1VCTUlUVEVELCBmaWxlKTsKICAgICAgfSwgZnVuY3Rpb24gKCkgewogICAgICAgIC8vIHdhaXRpbmcgdWkKICAgICAgICBfdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMudXBsb2FkKCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIHJlbW92ZUZpbGU6IGZ1bmN0aW9uIHJlbW92ZUZpbGUoZmlsZSkgewogICAgICB0aGlzLiRlbWl0KEVWRU5UX1JFTU9WRUQsIGZpbGUpOwogICAgICBmaWxlLl94aHIgJiYgZmlsZS5feGhyLmFib3J0KCk7CgogICAgICBpZiAoZmlsZS51cmwpIHsKICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKGZpbGUudXJsKTsKICAgICAgfQoKICAgICAgdmFyIGluZGV4ID0gdGhpcy5maWxlcy5pbmRleE9mKGZpbGUpOwogICAgICB0aGlzLmZpbGVzLnNwbGljZShpbmRleCwgMSk7CiAgICAgIHRoaXMudXBsb2FkKCk7CiAgICB9LAogICAgZmlsZUNsaWNrOiBmdW5jdGlvbiBmaWxlQ2xpY2soZmlsZSwgaW5kZXgpIHsKICAgICAgdGhpcy4kZW1pdChFVkVOVF9DTElDSywgZmlsZSwgaW5kZXgpOwogICAgfSwKICAgIHVwbG9hZDogZnVuY3Rpb24gdXBsb2FkKHJldHJ5KSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLmFjdGlvbk9wdGlvbnM7CgogICAgICBpZiAodGhpcy5wYXVzZWQgfHwgIW9wdGlvbnMpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBsZW4gPSB0aGlzLmZpbGVzLmxlbmd0aDsKICAgICAgdmFyIHVwbG9hZGluZ0NvdW50ID0gMDsKICAgICAgdmFyIGkgPSAwOwoKICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoKSB7CiAgICAgICAgdmFyIGZpbGUgPSBfdGhpczIuZmlsZXNbaV07CiAgICAgICAgdmFyIHN0YXR1cyA9IGZpbGUuc3RhdHVzOwoKICAgICAgICBpZiAoc3RhdHVzID09PSBTVEFUVVNfUkVBRFkgfHwgcmV0cnkgJiYgc3RhdHVzID09PSBTVEFUVVNfRVJST1IgJiYgZmlsZS5fcmV0cnlJZCAhPT0gX3RoaXMyLnJldHJ5SWQpIHsKICAgICAgICAgIGFqYXhVcGxvYWQoZmlsZSwgb3B0aW9ucywgZnVuY3Rpb24gKGZpbGUpIHsKICAgICAgICAgICAgaWYgKHN0YXR1cyA9PT0gU1RBVFVTX0VSUk9SKSB7CiAgICAgICAgICAgICAgZmlsZS5fcmV0cnlJZCA9IF90aGlzMi5yZXRyeUlkOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczIuJGVtaXQoZmlsZS5zdGF0dXMgPT09IFNUQVRVU19TVUNDRVNTID8gRVZFTlRfU1VDQ0VTUyA6IEVWRU5UX0VSUk9SLCBmaWxlKTsKCiAgICAgICAgICAgIF90aGlzMi51cGxvYWQocmV0cnkpOwogICAgICAgICAgfSk7CiAgICAgICAgICB1cGxvYWRpbmdDb3VudCsrOwogICAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09PSBTVEFUVVNfVVBMT0FESU5HKSB7CiAgICAgICAgICB1cGxvYWRpbmdDb3VudCsrOwogICAgICAgIH0KCiAgICAgICAgaSsrOwogICAgICB9OwoKICAgICAgd2hpbGUgKGkgPCBsZW4gJiYgdXBsb2FkaW5nQ291bnQgPCB0aGlzLnNpbXVsdGFuZW91c1VwbG9hZHMpIHsKICAgICAgICBfbG9vcCgpOwogICAgICB9CiAgICB9LAogICAgc3RhcnQ6IGZ1bmN0aW9uIHN0YXJ0KCkgewogICAgICB0aGlzLnBhdXNlZCA9IGZhbHNlOwogICAgICB0aGlzLnVwbG9hZCgpOwogICAgfSwKICAgIHBhdXNlOiBmdW5jdGlvbiBwYXVzZSgpIHsKICAgICAgdGhpcy5wYXVzZWQgPSB0cnVlOwogICAgICB0aGlzLmZpbGVzLmZvckVhY2goZnVuY3Rpb24gKGZpbGUpIHsKICAgICAgICBpZiAoZmlsZS5zdGF0dXMgPT09IFNUQVRVU19VUExPQURJTkcpIHsKICAgICAgICAgIGZpbGUuX3hoci5hYm9ydCgpOwoKICAgICAgICAgIGZpbGUuc3RhdHVzID0gU1RBVFVTX1JFQURZOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgcmV0cnk6IGZ1bmN0aW9uIHJldHJ5KCkgewogICAgICB0aGlzLnJldHJ5SWQgPSBEYXRlLm5vdygpOwogICAgICB0aGlzLnBhdXNlZCA9IGZhbHNlOwogICAgICB0aGlzLnVwbG9hZCh0cnVlKTsKICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgIFVwbG9hZEJ0bjogVXBsb2FkQnRuLAogICAgVXBsb2FkRmlsZTogVXBsb2FkRmlsZQogIH0KfTs="},{"version":3,"sources":["upload.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"cube-upload\">\n    <slot>\n      <div class=\"cube-upload-def clear-fix\">\n        <upload-file v-for=\"(file, i) in files\" :file=\"file\" :key=\"i\" @click=\"fileClick(file, i)\"></upload-file>\n        <upload-btn :multiple=\"multiple\" :accept=\"accept\" v-show=\"isShowBtn\"></upload-btn>\n      </div>\n    </slot>\n  </div>\n</template>\n<script type=\"text/ecmascript-6\">\n  import UploadBtn from './btn.vue'\n  import UploadFile from './file.vue'\n  import ajaxUpload from './ajax'\n  import btnMixin from './btn-mixin'\n  import {\n    processFiles,\n    newFile,\n    URL,\n    STATUS_READY,\n    STATUS_UPLOADING,\n    STATUS_ERROR,\n    STATUS_SUCCESS\n  } from './util'\n\n  const COMPONENT_NAME = 'cube-upload'\n  const EVENT_INPUT = 'input'\n  const EVENT_ADDED = 'files-added'\n  const EVENT_SUBMITTED = 'file-submitted'\n  const EVENT_REMOVED = 'file-removed'\n  const EVENT_SUCCESS = 'file-success'\n  const EVENT_ERROR = 'file-error'\n  const EVENT_CLICK = 'file-click'\n\n  export default {\n    name: COMPONENT_NAME,\n    mixins: [btnMixin],\n    props: {\n      value: {\n        type: Array,\n        default() {\n          return []\n        }\n      },\n      action: {\n        type: [String, Object],\n        default: ''\n      },\n      max: {\n        type: Number,\n        default: 10\n      },\n      auto: {\n        type: Boolean,\n        default: true\n      },\n      simultaneousUploads: {\n        type: Number,\n        default: 1\n      },\n      processFile: {\n        type: Function,\n        default: function (file, cb) {\n          cb(file)\n        }\n      }\n    },\n    data() {\n      return {\n        files: this.value,\n        paused: !this.auto\n      }\n    },\n    computed: {\n      actionOptions() {\n        const action = this.action\n        if (typeof action === 'string') {\n          return action ? {\n            target: action\n          } : null\n        } else {\n          return action\n        }\n      },\n      isShowBtn() {\n        return this.files.length < this.max\n      }\n    },\n    watch: {\n      value(newVal) {\n        this.files = newVal\n      },\n      files(newFiles) {\n        this.$emit(EVENT_INPUT, newFiles)\n      }\n    },\n    methods: {\n      addFiles(files) {\n        this.$emit(EVENT_ADDED, files)\n        const filesLen = this.files.length\n        const newFiles = []\n        const maxLen = this.max - filesLen\n        let i = 0\n        let file = files[i]\n        while (newFiles.length < maxLen && file) {\n          if (!file.ignore) {\n            newFiles.push(file)\n            this.files.push(newFile())\n          }\n          file = files[++i]\n        }\n        processFiles(newFiles, this.processFile, (file, index) => {\n          this.$set(this.files, filesLen + index, file)\n          this.$emit(EVENT_SUBMITTED, file)\n        }, () => {\n          // waiting ui\n          this.$nextTick(() => {\n            this.upload()\n          })\n        })\n      },\n      removeFile(file) {\n        this.$emit(EVENT_REMOVED, file)\n        file._xhr && file._xhr.abort()\n        if (file.url) {\n          URL.revokeObjectURL(file.url)\n        }\n        const index = this.files.indexOf(file)\n        this.files.splice(index, 1)\n        this.upload()\n      },\n      fileClick(file, index) {\n        this.$emit(EVENT_CLICK, file, index)\n      },\n      upload(retry) {\n        const options = this.actionOptions\n        if (this.paused || !options) {\n          return\n        }\n        const len = this.files.length\n        let uploadingCount = 0\n        let i = 0\n        while (i < len && uploadingCount < this.simultaneousUploads) {\n          const file = this.files[i]\n          const status = file.status\n          if (status === STATUS_READY || (retry && status === STATUS_ERROR && file._retryId !== this.retryId)) {\n            ajaxUpload(file, options, (file) => {\n              if (status === STATUS_ERROR) {\n                file._retryId = this.retryId\n              }\n              this.$emit(file.status === STATUS_SUCCESS ? EVENT_SUCCESS : EVENT_ERROR, file)\n              this.upload(retry)\n            })\n            uploadingCount++\n          } else if (status === STATUS_UPLOADING) {\n            uploadingCount++\n          }\n          i++\n        }\n      },\n      start() {\n        this.paused = false\n        this.upload()\n      },\n      pause() {\n        this.paused = true\n        this.files.forEach((file) => {\n          if (file.status === STATUS_UPLOADING) {\n            file._xhr.abort()\n            file.status = STATUS_READY\n          }\n        })\n      },\n      retry() {\n        this.retryId = Date.now()\n        this.paused = false\n        this.upload(true)\n      }\n    },\n    components: {\n      UploadBtn,\n      UploadFile\n    }\n  }\n</script>\n<style lang=\"stylus\" rel=\"stylesheet/stylus\">\n  @require \"../../common/stylus/variable.styl\"\n  .cube-upload\n    position: relative\n\n  .cube-upload-def\n    margin-right: -10px\n    .cube-upload-btn, .cube-upload-file\n      float: left\n      margin: 0 10px 10px 0\n</style>\n"],"sourceRoot":"node_modules/_cube-ui@1.12.44@cube-ui/src/components/upload"}]}