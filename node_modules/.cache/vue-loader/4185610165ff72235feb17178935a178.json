{"remainingRequest":"D:\\vue-project\\xdclass_front\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js??vue-loader-options!D:\\vue-project\\xdclass_front\\node_modules\\_cube-ui@1.12.44@cube-ui\\src\\components\\image-preview\\image-preview.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\vue-project\\xdclass_front\\node_modules\\_cube-ui@1.12.44@cube-ui\\src\\components\\image-preview\\image-preview.vue","mtime":499162500000},{"path":"D:\\vue-project\\xdclass_front\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-project\\xdclass_front\\node_modules\\_babel-loader@8.2.2@babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\vue-project\\xdclass_front\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue-project\\xdclass_front\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBDdWJlUG9wdXAgZnJvbSAnLi4vcG9wdXAvcG9wdXAudnVlJwppbXBvcnQgQ3ViZVNsaWRlIGZyb20gJy4uL3NsaWRlL3NsaWRlLnZ1ZScKaW1wb3J0IEN1YmVTbGlkZUl0ZW0gZnJvbSAnLi4vc2xpZGUvc2xpZGUtaXRlbS52dWUnCmltcG9ydCBDdWJlU2Nyb2xsIGZyb20gJy4uL3Njcm9sbC9zY3JvbGwudnVlJwppbXBvcnQgdmlzaWJpbGl0eU1peGluIGZyb20gJy4uLy4uL2NvbW1vbi9taXhpbnMvdmlzaWJpbGl0eScKaW1wb3J0IHBvcHVwTWl4aW4gZnJvbSAnLi4vLi4vY29tbW9uL21peGlucy9wb3B1cCcKaW1wb3J0IHsgaXNBbmRyb2lkIH0gZnJvbSAnLi4vLi4vY29tbW9uL2hlbHBlcnMvZW52JwppbXBvcnQgeyBVU0VfVFJBTlNJVElPTiB9IGZyb20gJy4uLy4uL2NvbW1vbi9ic2Nyb2xsL2NvbnN0YW50cycKCmNvbnN0IENPTVBPTkVOVF9OQU1FID0gJ2N1YmUtaW1hZ2UtcHJldmlldycKY29uc3QgRVZFTlRfQ0hBTkdFID0gJ2NoYW5nZScKY29uc3QgRVZFTlRfSElERSA9ICdoaWRlJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6IENPTVBPTkVOVF9OQU1FLAogIG1peGluczogW3Zpc2liaWxpdHlNaXhpbiwgcG9wdXBNaXhpbl0sCiAgcHJvcHM6IHsKICAgIGluaXRpYWxJbmRleDogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDAKICAgIH0sCiAgICBpbWdzOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0KCkgewogICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICAgICAgcmV0dXJuIFtdCiAgICAgIH0KICAgIH0sCiAgICBsb29wOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCiAgICBzcGVlZDogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDQwMAogICAgfSwKICAgIHByZXZlbnREZWZhdWx0OiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjdXJyZW50UGFnZUluZGV4OiB0aGlzLmluaXRpYWxJbmRleCwKICAgICAgb3B0aW9uczogewogICAgICAgIG9ic2VydmVET006IGZhbHNlLAogICAgICAgIGJvdW5jZTogewogICAgICAgICAgbGVmdDogdHJ1ZSwKICAgICAgICAgIHJpZ2h0OiB0cnVlCiAgICAgICAgfSwKICAgICAgICB1c2VUcmFuc2l0aW9uOiBpc0FuZHJvaWQgPyBmYWxzZSA6IFVTRV9UUkFOU0lUSU9OLAogICAgICAgIHByb2JlVHlwZTogMywKICAgICAgICBwcmV2ZW50RGVmYXVsdDogdGhpcy5wcmV2ZW50RGVmYXVsdAogICAgICB9LAogICAgICBzY3JvbGxPcHRpb25zOiB7CiAgICAgICAgdXNlVHJhbnNpdGlvbjogVVNFX1RSQU5TSVRJT04sCiAgICAgICAgSFdDb21wb3NpdGluZzogaXNBbmRyb2lkLAogICAgICAgIG9ic2VydmVET006IGZhbHNlLAogICAgICAgIHpvb206IHRydWUsCiAgICAgICAgYmluZFRvV3JhcHBlcjogdHJ1ZSwKICAgICAgICBmcmVlU2Nyb2xsOiB0cnVlLAogICAgICAgIHNjcm9sbFg6IHRydWUsCiAgICAgICAgc2Nyb2xsWTogdHJ1ZSwKICAgICAgICBwcm9iZVR5cGU6IDMsCiAgICAgICAgYm91bmNlOiBmYWxzZSwKICAgICAgICBjbGljazogZmFsc2UsCiAgICAgICAgZGJsY2xpY2s6IHRydWUsCiAgICAgICAgYm91bmNlVGltZTogMzAwLAogICAgICAgIHByZXZlbnREZWZhdWx0OiB0aGlzLnByZXZlbnREZWZhdWx0CiAgICAgIH0KICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICBpbml0aWFsSW5kZXgobmV3SW5kZXgpIHsKICAgICAgdGhpcy5zZXRQYWdlSW5kZXgobmV3SW5kZXgpCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBzaG93KCkgewogICAgICB0aGlzLmlzVmlzaWJsZSA9IHRydWUKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMuX2xpc3RlblNsaWRlKCkKICAgICAgICB0aGlzLl9saXN0ZW5TY3JvbGwoKQogICAgICB9KQogICAgfSwKICAgIF9saXN0ZW5TbGlkZSgpIHsKICAgICAgLy8gd2FpdGluZyBzbGlkZSBpbml0aWFsCiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICBjb25zdCBzbGlkZSA9IHRoaXMuJHJlZnMuc2xpZGUuc2xpZGUKICAgICAgICBzbGlkZS5vbignc2Nyb2xsU3RhcnQnLCB0aGlzLnNsaWRlU2Nyb2xsU3RhcnRIYW5kbGVyKQogICAgICAgIHNsaWRlLm9uKCdzY3JvbGxFbmQnLCB0aGlzLnNsaWRlU2Nyb2xsRW5kSGFuZGxlcikKICAgICAgfSkKICAgIH0sCiAgICBfbGlzdGVuU2Nyb2xsKCkgewogICAgICAvLyB3YWl0aW5nIHNjcm9sbCBpbml0aWFsCiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICB0aGlzLiRyZWZzLml0ZW1zLmZvckVhY2goKHNjcm9sbEl0ZW0pID0+IHsKICAgICAgICAgIGNvbnN0IHNjcm9sbCA9IHNjcm9sbEl0ZW0uc2Nyb2xsCiAgICAgICAgICBzY3JvbGwub24oJ3pvb21TdGFydCcsIHRoaXMuem9vbVN0YXJ0SGFuZGxlci5iaW5kKHRoaXMsIHNjcm9sbCkpCiAgICAgICAgICBzY3JvbGwub24oJ2JlZm9yZVNjcm9sbFN0YXJ0JywgdGhpcy5iZWZvcmVTY3JvbGxIYW5kbGVyKQogICAgICAgICAgc2Nyb2xsLm9uKCdzY3JvbGwnLCB0aGlzLmNoZWNrQm91bmRhcnkuYmluZCh0aGlzLCBzY3JvbGwpKQogICAgICAgICAgc2Nyb2xsLm9uKCdzY3JvbGxFbmQnLCB0aGlzLnNjcm9sbEVuZEhhbmRsZXIuYmluZCh0aGlzLCBzY3JvbGwpKQogICAgICAgIH0pCiAgICAgIH0pCiAgICB9LAogICAgaGlkZSgpIHsKICAgICAgdGhpcy5pc1Zpc2libGUgPSBmYWxzZQogICAgICB0aGlzLiRlbWl0KEVWRU5UX0hJREUpCiAgICB9LAogICAgcHJldigpIHsKICAgICAgY29uc3Qgc2xpZGUgPSB0aGlzLiRyZWZzLnNsaWRlLnNsaWRlCiAgICAgIHNsaWRlICYmIHNsaWRlLnByZXYoKQogICAgfSwKICAgIG5leHQoKSB7CiAgICAgIGNvbnN0IHNsaWRlID0gdGhpcy4kcmVmcy5zbGlkZS5zbGlkZQogICAgICBzbGlkZSAmJiBzbGlkZS5uZXh0KCkKICAgIH0sCiAgICBnb1RvKGluZGV4KSB7CiAgICAgIGNvbnN0IHNsaWRlID0gdGhpcy4kcmVmcy5zbGlkZS5zbGlkZQogICAgICBzbGlkZSAmJiBzbGlkZS5nb1RvUGFnZShpbmRleCwgMCkKICAgIH0sCiAgICBpbWdMb2FkKGkpIHsKICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgICAgIGlmICh0aGlzLmlzVmlzaWJsZSAmJiB0aGlzLiRyZWZzLml0ZW1zKSB7CiAgICAgICAgdGhpcy4kcmVmcy5pdGVtc1tpXS5zY3JvbGwucmVmcmVzaCgpCiAgICAgIH0KICAgIH0sCiAgICBzZXRQYWdlSW5kZXgoY3VycmVudFBhZ2VJbmRleCkgewogICAgICBpZiAodGhpcy5jdXJyZW50UGFnZUluZGV4ID49IDAgJiYgdGhpcy5jdXJyZW50UGFnZUluZGV4ICE9PSBjdXJyZW50UGFnZUluZGV4KSB7CiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuJHJlZnMuaXRlbXNbdGhpcy5jdXJyZW50UGFnZUluZGV4XQogICAgICAgIGlmIChpdGVtKSB7CiAgICAgICAgICBjb25zdCBzY3JvbGwgPSBpdGVtLnNjcm9sbAogICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovCiAgICAgICAgICBpZiAoc2Nyb2xsLnNjYWxlICE9PSAxKSB7CiAgICAgICAgICAgIHNjcm9sbC5zY2FsZSA9IDEKICAgICAgICAgICAgc2Nyb2xsLmxhc3RjYWxlID0gMQogICAgICAgICAgICBzY3JvbGwucmVmcmVzaCgpCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuY3VycmVudFBhZ2VJbmRleCA9IGN1cnJlbnRQYWdlSW5kZXgKICAgIH0sCiAgICBzbGlkZUNoYW5nZUhhbmRsZXIoY3VycmVudFBhZ2VJbmRleCkgewogICAgICB0aGlzLnNldFBhZ2VJbmRleChjdXJyZW50UGFnZUluZGV4KQogICAgICB0aGlzLnNsaWRlU2Nyb2xsRW5kSGFuZGxlcigpCiAgICAgIHRoaXMuJGVtaXQoRVZFTlRfQ0hBTkdFLCBjdXJyZW50UGFnZUluZGV4KQogICAgfSwKICAgIHNsaWRlU2Nyb2xsU3RhcnRIYW5kbGVyKCkgewogICAgICBjb25zdCBzbGlkZSA9IHRoaXMuJHJlZnMuc2xpZGUuc2xpZGUKICAgICAgaWYgKHRoaXMuX3Njcm9sbGluZyAmJiAhdGhpcy5faGFzRW5hYmxlU2xpZGUpIHsKICAgICAgICBzbGlkZS5kaXNhYmxlKCkKICAgICAgfSBlbHNlIHsKICAgICAgICBzbGlkZS5lbmFibGUoKQogICAgICB9CiAgICB9LAogICAgc2xpZGVTY3JvbGxFbmRIYW5kbGVyKCkgewogICAgICB0aGlzLiRyZWZzLml0ZW1zLmZvckVhY2goKHNjcm9sbEl0ZW0pID0+IHsKICAgICAgICB0aGlzLnNjcm9sbEVuZEhhbmRsZXIoc2Nyb2xsSXRlbS5zY3JvbGwpCiAgICAgIH0pCiAgICB9LAogICAgX3Njcm9sbChzY3JvbGwpIHsKICAgICAgY29uc3Qgc2xpZGUgPSB0aGlzLiRyZWZzLnNsaWRlLnNsaWRlCiAgICAgIHNsaWRlLmRpc2FibGUoKQogICAgICBzbGlkZS5yZWZyZXNoKCkKICAgICAgc2Nyb2xsLmVuYWJsZSgpCiAgICB9LAogICAgX3NsaWRlKHNjcm9sbCkgewogICAgICB0aGlzLiRyZWZzLnNsaWRlLnNsaWRlLmVuYWJsZSgpCiAgICAgIHNjcm9sbC5kaXNhYmxlKCkKICAgIH0sCiAgICBiZWZvcmVTY3JvbGxIYW5kbGVyKCkgewogICAgICAvLyBmb3IgdG91Y2hzdGFydCBzY3JvbGxFbmQKICAgICAgLy8gY2FuY2VsIGl0LCBkbyBub3QgZW5hYmxlIHNsaWRlCiAgICAgIGNsZWFyVGltZW91dCh0aGlzLmVuYWJsZVNsaWRlVGlkKQogICAgfSwKICAgIHNjcm9sbEVuZEhhbmRsZXIoc2Nyb2xsKSB7CiAgICAgIGNsZWFyVGltZW91dCh0aGlzLmVuYWJsZVNsaWRlVGlkKQogICAgICBpZiAodGhpcy5kYmxab29taW5nKSB7CiAgICAgICAgdGhpcy5kYmxab29taW5nID0gZmFsc2UKICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5jbGlja1RpZCkKICAgICAgfQogICAgICB0aGlzLl9oYXNFbmFibGVTbGlkZSA9IGZhbHNlCiAgICAgIHRoaXMuX3Njcm9sbGluZyA9IGZhbHNlCiAgICAgIHNjcm9sbC5lbmFibGUoKQogICAgICB0aGlzLmVuYWJsZVNsaWRlVGlkID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgdGhpcy4kcmVmcy5zbGlkZS5zbGlkZS5lbmFibGUoKQogICAgICB9KQogICAgfSwKICAgIGNoZWNrQm91bmRhcnkoc2Nyb2xsLCBwb3MpIHsKICAgICAgaWYgKHNjcm9sbC5kaXN0WCAmJiBNYXRoLmFicyhzY3JvbGwuZGlzdFgpID4gTWF0aC5hYnMoc2Nyb2xsLmRpc3RZKSkgewogICAgICAgIHRoaXMuX3Njcm9sbGluZyA9IHRydWUKICAgICAgICBjb25zdCByZWFjaGVkID0gc2Nyb2xsLmRpc3RYID4gMCA/IHBvcy54ID49IHNjcm9sbC5taW5TY3JvbGxYIDogcG9zLnggPD0gc2Nyb2xsLm1heFNjcm9sbFgKICAgICAgICBpZiAocmVhY2hlZCkgewogICAgICAgICAgdGhpcy5faGFzRW5hYmxlU2xpZGUgPSB0cnVlCiAgICAgICAgICB0aGlzLl9zbGlkZShzY3JvbGwpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmICghdGhpcy5faGFzRW5hYmxlU2xpZGUpIHsKICAgICAgICAgICAgdGhpcy5fc2Nyb2xsKHNjcm9sbCkKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoc2Nyb2xsLmRpc3RZKSB7CiAgICAgICAgdGhpcy5fc2Nyb2xsaW5nID0gdHJ1ZQogICAgICAgIHRoaXMuX3Njcm9sbChzY3JvbGwpCiAgICAgIH0KICAgIH0sCiAgICB6b29tU3RhcnRIYW5kbGVyKHNjcm9sbCkgewogICAgICB0aGlzLl9zY3JvbGwoc2Nyb2xsKQogICAgfSwKICAgIGRibGNsaWNrSGFuZGxlcihpbmRleCwgZSkgewogICAgICBjb25zdCBzY3JvbGwgPSB0aGlzLiRyZWZzLml0ZW1zW2luZGV4XS5zY3JvbGwKICAgICAgdGhpcy5kYmxab29taW5nID0gdHJ1ZQogICAgICB0aGlzLnpvb21UbyhzY3JvbGwsIHNjcm9sbC5zY2FsZSA+IDEgPyAxIDogMiwgZSkKICAgICAgc2Nyb2xsLmRpc2FibGUoKQogICAgfSwKICAgIGl0ZW1DbGlja0hhbmRsZXIoKSB7CiAgICAgIGNsZWFyVGltZW91dCh0aGlzLmNsaWNrVGlkKQogICAgICB0aGlzLmNsaWNrVGlkID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgIXRoaXMuZGJsWm9vbWluZyAmJiB0aGlzLmhpZGUoKQogICAgICB9LCB0aGlzLnNjcm9sbE9wdGlvbnMuYm91bmNlVGltZSkKICAgIH0sCiAgICB6b29tVG8oc2Nyb2xsLCBzY2FsZSwgZSkgewogICAgICBzY3JvbGwuem9vbVRvKHNjYWxlLCBlLnBhZ2VYLCBlLnBhZ2VZKQogICAgfQogIH0sCiAgY29tcG9uZW50czogewogICAgQ3ViZVBvcHVwLAogICAgQ3ViZVNsaWRlLAogICAgQ3ViZVNsaWRlSXRlbSwKICAgIEN1YmVTY3JvbGwKICB9Cn0K"},{"version":3,"sources":["image-preview.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"image-preview.vue","sourceRoot":"node_modules/_cube-ui@1.12.44@cube-ui/src/components/image-preview","sourcesContent":["<template>\n  <transition name=\"cube-image-preview-fade\">\n    <cube-popup type=\"image-preview\" :z-index=\"zIndex\" :center=\"false\" v-show=\"isVisible\">\n      <div class=\"cube-image-preview-container\">\n        <div class=\"cube-image-preview-header\">\n          <slot name=\"header\" :current=\"currentPageIndex\"></slot>\n        </div>\n        <cube-slide\n          ref=\"slide\"\n          v-if=\"isVisible\"\n          :data=\"imgs\"\n          :initial-index=\"currentPageIndex\"\n          :auto-play=\"false\"\n          :loop=\"loop\"\n          :speed=\"speed\"\n          :options=\"options\"\n          @change=\"slideChangeHandler\"\n        >\n          <cube-slide-item\n            v-for=\"(img, index) in imgs\"\n            :key=\"index\"\n          >\n            <div class=\"cube-image-preview-item\" @click=\"itemClickHandler\">\n              <cube-scroll\n                ref=\"items\"\n                :options=\"scrollOptions\"\n                @dblclick.native=\"dblclickHandler(index, $event)\"\n              >\n                <img class=\"cube-image-preview-img\" :src=\"img\" @load=\"imgLoad(index)\">\n              </cube-scroll>\n            </div>\n          </cube-slide-item>\n          <template slot=\"dots\"><i></i></template>\n        </cube-slide>\n        <div class=\"cube-image-preview-footer\">\n          <slot name=\"footer\" :current=\"currentPageIndex\">\n            <span class=\"cube-image-preview-counter\">{{currentPageIndex + 1}}/{{imgs.length}}</span>\n          </slot>\n        </div>\n      </div>\n    </cube-popup>\n  </transition>\n</template>\n<script type=\"text/ecmascript-6\">\n  import CubePopup from '../popup/popup.vue'\n  import CubeSlide from '../slide/slide.vue'\n  import CubeSlideItem from '../slide/slide-item.vue'\n  import CubeScroll from '../scroll/scroll.vue'\n  import visibilityMixin from '../../common/mixins/visibility'\n  import popupMixin from '../../common/mixins/popup'\n  import { isAndroid } from '../../common/helpers/env'\n  import { USE_TRANSITION } from '../../common/bscroll/constants'\n\n  const COMPONENT_NAME = 'cube-image-preview'\n  const EVENT_CHANGE = 'change'\n  const EVENT_HIDE = 'hide'\n\n  export default {\n    name: COMPONENT_NAME,\n    mixins: [visibilityMixin, popupMixin],\n    props: {\n      initialIndex: {\n        type: Number,\n        default: 0\n      },\n      imgs: {\n        type: Array,\n        default() {\n          /* istanbul ignore next */\n          return []\n        }\n      },\n      loop: {\n        type: Boolean,\n        default: true\n      },\n      speed: {\n        type: Number,\n        default: 400\n      },\n      preventDefault: {\n        type: Boolean,\n        default: true\n      }\n    },\n    data() {\n      return {\n        currentPageIndex: this.initialIndex,\n        options: {\n          observeDOM: false,\n          bounce: {\n            left: true,\n            right: true\n          },\n          useTransition: isAndroid ? false : USE_TRANSITION,\n          probeType: 3,\n          preventDefault: this.preventDefault\n        },\n        scrollOptions: {\n          useTransition: USE_TRANSITION,\n          HWCompositing: isAndroid,\n          observeDOM: false,\n          zoom: true,\n          bindToWrapper: true,\n          freeScroll: true,\n          scrollX: true,\n          scrollY: true,\n          probeType: 3,\n          bounce: false,\n          click: false,\n          dblclick: true,\n          bounceTime: 300,\n          preventDefault: this.preventDefault\n        }\n      }\n    },\n    watch: {\n      initialIndex(newIndex) {\n        this.setPageIndex(newIndex)\n      }\n    },\n    methods: {\n      show() {\n        this.isVisible = true\n        this.$nextTick(() => {\n          this._listenSlide()\n          this._listenScroll()\n        })\n      },\n      _listenSlide() {\n        // waiting slide initial\n        this.$nextTick(() => {\n          const slide = this.$refs.slide.slide\n          slide.on('scrollStart', this.slideScrollStartHandler)\n          slide.on('scrollEnd', this.slideScrollEndHandler)\n        })\n      },\n      _listenScroll() {\n        // waiting scroll initial\n        this.$nextTick(() => {\n          this.$refs.items.forEach((scrollItem) => {\n            const scroll = scrollItem.scroll\n            scroll.on('zoomStart', this.zoomStartHandler.bind(this, scroll))\n            scroll.on('beforeScrollStart', this.beforeScrollHandler)\n            scroll.on('scroll', this.checkBoundary.bind(this, scroll))\n            scroll.on('scrollEnd', this.scrollEndHandler.bind(this, scroll))\n          })\n        })\n      },\n      hide() {\n        this.isVisible = false\n        this.$emit(EVENT_HIDE)\n      },\n      prev() {\n        const slide = this.$refs.slide.slide\n        slide && slide.prev()\n      },\n      next() {\n        const slide = this.$refs.slide.slide\n        slide && slide.next()\n      },\n      goTo(index) {\n        const slide = this.$refs.slide.slide\n        slide && slide.goToPage(index, 0)\n      },\n      imgLoad(i) {\n        /* istanbul ignore if */\n        if (this.isVisible && this.$refs.items) {\n          this.$refs.items[i].scroll.refresh()\n        }\n      },\n      setPageIndex(currentPageIndex) {\n        if (this.currentPageIndex >= 0 && this.currentPageIndex !== currentPageIndex) {\n          const item = this.$refs.items[this.currentPageIndex]\n          if (item) {\n            const scroll = item.scroll\n            /* istanbul ignore if */\n            if (scroll.scale !== 1) {\n              scroll.scale = 1\n              scroll.lastcale = 1\n              scroll.refresh()\n            }\n          }\n        }\n        this.currentPageIndex = currentPageIndex\n      },\n      slideChangeHandler(currentPageIndex) {\n        this.setPageIndex(currentPageIndex)\n        this.slideScrollEndHandler()\n        this.$emit(EVENT_CHANGE, currentPageIndex)\n      },\n      slideScrollStartHandler() {\n        const slide = this.$refs.slide.slide\n        if (this._scrolling && !this._hasEnableSlide) {\n          slide.disable()\n        } else {\n          slide.enable()\n        }\n      },\n      slideScrollEndHandler() {\n        this.$refs.items.forEach((scrollItem) => {\n          this.scrollEndHandler(scrollItem.scroll)\n        })\n      },\n      _scroll(scroll) {\n        const slide = this.$refs.slide.slide\n        slide.disable()\n        slide.refresh()\n        scroll.enable()\n      },\n      _slide(scroll) {\n        this.$refs.slide.slide.enable()\n        scroll.disable()\n      },\n      beforeScrollHandler() {\n        // for touchstart scrollEnd\n        // cancel it, do not enable slide\n        clearTimeout(this.enableSlideTid)\n      },\n      scrollEndHandler(scroll) {\n        clearTimeout(this.enableSlideTid)\n        if (this.dblZooming) {\n          this.dblZooming = false\n          clearTimeout(this.clickTid)\n        }\n        this._hasEnableSlide = false\n        this._scrolling = false\n        scroll.enable()\n        this.enableSlideTid = setTimeout(() => {\n          this.$refs.slide.slide.enable()\n        })\n      },\n      checkBoundary(scroll, pos) {\n        if (scroll.distX && Math.abs(scroll.distX) > Math.abs(scroll.distY)) {\n          this._scrolling = true\n          const reached = scroll.distX > 0 ? pos.x >= scroll.minScrollX : pos.x <= scroll.maxScrollX\n          if (reached) {\n            this._hasEnableSlide = true\n            this._slide(scroll)\n          } else {\n            if (!this._hasEnableSlide) {\n              this._scroll(scroll)\n            }\n          }\n        } else if (scroll.distY) {\n          this._scrolling = true\n          this._scroll(scroll)\n        }\n      },\n      zoomStartHandler(scroll) {\n        this._scroll(scroll)\n      },\n      dblclickHandler(index, e) {\n        const scroll = this.$refs.items[index].scroll\n        this.dblZooming = true\n        this.zoomTo(scroll, scroll.scale > 1 ? 1 : 2, e)\n        scroll.disable()\n      },\n      itemClickHandler() {\n        clearTimeout(this.clickTid)\n        this.clickTid = setTimeout(() => {\n          !this.dblZooming && this.hide()\n        }, this.scrollOptions.bounceTime)\n      },\n      zoomTo(scroll, scale, e) {\n        scroll.zoomTo(scale, e.pageX, e.pageY)\n      }\n    },\n    components: {\n      CubePopup,\n      CubeSlide,\n      CubeSlideItem,\n      CubeScroll\n    }\n  }\n</script>\n<style lang=\"stylus\" rel=\"stylesheet/stylus\">\n  @require \"../../common/stylus/variable.styl\"\n\n  .cube-image-preview-fade-enter, .cube-image-preview-fade-leave-active\n    opacity: 0\n  .cube-image-preview-fade-enter-active, .cube-image-preview-fade-leave-active\n    transition: all .3s ease-in-out\n\n  .cube-image-preview\n    .cube-popup-mask\n      opacity: .6\n    .cube-popup-content\n      width: 100%\n      height: 100%\n    .cube-slide-item\n      display: flex\n      align-items: center\n      justify-content: center\n      overflow: hidden\n  .cube-image-preview-container\n    height: 100%\n    margin: 0 -10px\n  .cube-image-preview-header,\n  .cube-image-preview-footer\n    position: absolute\n    left: 0\n    right: 0\n  .cube-image-preview-header\n    top: 0\n  .cube-image-preview-footer\n    bottom: 0\n  .cube-image-preview-counter\n    position: absolute\n    bottom: 50px\n    width: 100%\n    text-align: center\n    font-size: $fontsize-medium\n    color: $image-preview-counter-color\n  .cube-image-preview-item\n    position: relative\n    padding: 0 10px\n    width: 100%\n    height: 100%\n    .cube-scroll-wrapper\n      display: flex\n      align-items: center\n      justify-content: center\n    .cube-image-preview-img\n      display: block\n      height: auto\n      max-width: 100%\n      max-height: 100%\n</style>\n"]}]}